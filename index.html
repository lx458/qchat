<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>量子计算VQE算法对话助手</title>
    <!-- 引入Tailwind CSS用于快速样式设计 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 对话气泡样式 */
        .user-bubble { background-color: #4F46E5; color: white; border-radius: 16px 16px 4px 16px; padding: 12px 16px; margin: 8px 0; max-width: 70%; align-self: flex-end; }
        .ai-bubble { background-color: #E5E7EB; color: #111827; border-radius: 16px 16px 16px 4px; padding: 12px 16px; margin: 8px 0; max-width: 70%; align-self: flex-start; }
        /* 滚动条美化 */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background-color: #9CA3AF; border-radius: 3px; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
    <!-- 导航栏 (简化) -->
    <nav class="bg-indigo-600 text-white p-4 shadow-md">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold">量子计算VQE算法对话助手</h1>
        </div>
    </nav>

    <!-- 主要内容区：直接就是对话界面 -->
    <main class="container mx-auto flex-1 p-4 md:p-6 flex flex-col h-[80vh]">
        <div class="bg-white rounded-xl shadow-md p-4 mb-4 flex-1 overflow-y-auto flex flex-col" id="chat-history">
            <!-- 欢迎语 -->
            <div class="ai-bubble">
                你好！我是量子计算VQE算法助手～ 我可以回答关于VQE原理、DeepQuantum安装、氢分子计算等问题。你可以直接输入问题，或者点击下方的快捷按钮提问。
            </div>
        </div>
        <div class="flex space-x-2">
            <input type="text" id="user-input" placeholder="输入你的问题..." class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
            <button onclick="sendMessage()" class="bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition-colors">发送</button>
        </div>
        <div class="flex flex-wrap gap-2 mt-3">
            <button onclick="quickQuestion('什么是VQE算法？')" class="bg-gray-200 hover:bg-gray-300 px-3 py-1 rounded text-sm">什么是VQE算法？</button>
            <button onclick="quickQuestion('如何安装DeepQuantum？')" class="bg-gray-200 hover:bg-gray-300 px-3 py-1 rounded text-sm">安装DeepQuantum</button>
            <button onclick="quickQuestion('氢分子的基态能量是多少？')" class="bg-gray-200 hover:bg-gray-300 px-3 py-1 rounded text-sm">氢分子能量？</button>
            <button onclick="quickQuestion('Ansatz电路怎么设计？')" class="bg-gray-200 hover:bg-gray-300 px-3 py-1 rounded text-sm">Ansatz电路设计？</button>
            <button onclick="quickQuestion('VQE为什么适用于量子化学？')" class="bg-gray-200 hover:bg-gray-300 px-3 py-1 rounded text-sm">VQE的优势？</button>
        </div>
    </main>

    <footer class="bg-indigo-600 text-white p-4 mt-8">
        <div class="container mx-auto text-center">
            <p>量子计算VQE算法课堂展示平台</p>
        </div>
    </footer>

<script>
    // 问题-答案映射库
    const qaLibrary = {
        "什么是vqe算法？": "VQE（变分量子本征求解器）是量子-经典混合算法，核心是通过迭代优化参数化量子电路（Ansatz），求解分子哈密顿量的最小本征值（基态能量），适用于NISQ量子硬件，是量子化学的核心算法。",
        "如何安装deepquantum？": "安装步骤如下：<br>1. 创建Conda环境：conda create -n dqenv python=3.12 -y<br>2. 激活环境：conda activate dqenv<br>3. 安装PyTorch：pip install torch<br>4. 安装DeepQuantum：pip install deepquantum（基础版）或pip install deepquantum[dev]（开发者版）",
        "氢分子的基态能量是多少？": "通过VQE算法计算，氢分子（H₂）的基态能量约为 <strong>-1.137 Hartree</strong>（1 Hartree≈27.211 eV），与实验值（-1.136 Ha）的误差小于0.1%，验证了算法的准确性。",
        "ansatz电路怎么设计？": "Ansatz是参数化量子电路，核心是「旋转门+纠缠门」的组合：<br>1. 旋转门（RX/RY/RZ）：引入可调参数，用于调整量子态<br>2. 纠缠门（CNOT/CZ）：实现量子比特间的关联，增加态空间表达能力<br>示例结构：RY(θ₀)→RY(θ₁)→CNOT→RY(θ₂)→RY(θ₃)（2量子比特）",
        "vqe为什么适用于量子化学？": "VQE适用于量子化学的两大核心原因：<br>1. 解决「维度灾难」：分子哈密顿量维度随电子数呈指数增长，经典计算机无法模拟<br>2. 适配NISQ硬件：仅需浅层电路，对量子比特数量、相干时间要求低，能容忍噪声"
    };

    // 快速提问功能
    function quickQuestion(question) {
        document.getElementById('user-input').value = question;
        sendMessage();
    }

    // 发送消息核心函数 (已修复匹配逻辑)
    function sendMessage() {
        const userInputField = document.getElementById('user-input');
        const userInput = userInputField.value.trim();
        if (!userInput) return;

        const chatHistory = document.getElementById('chat-history');
        
        // 1. 添加用户消息
        const userBubble = document.createElement('div');
        userBubble.className = 'user-bubble';
        userBubble.textContent = userInput;
        chatHistory.appendChild(userBubble);

        // 2. 清空输入框并滚动到底部
        userInputField.value = '';
        chatHistory.scrollTop = chatHistory.scrollHeight;

        // 关键修复：统一处理用户输入和qaLibrary的问题（去掉标点+转小写）
        const processText = (text) => text.replace(/[^\u4e00-\u9fa5a-z0-9]/g, '').toLowerCase();
        const processedUserInput = processText(userInput);

        // 3. 匹配答案（对qaLibrary的键也做同样处理）
        const matchedAnswer = qaLibrary[Object.keys(qaLibrary).find(key => 
            processText(key) === processedUserInput
        )];

        // 4. 模拟AI思考并回复
        setTimeout(() => {
            const aiBubble = document.createElement('div');
            aiBubble.className = 'ai-bubble';
            aiBubble.innerHTML = matchedAnswer || "抱歉，我暂时无法回答这个问题。你可以试试问：<br>• 什么是VQE算法？<br>• 如何安装DeepQuantum？";
            chatHistory.appendChild(aiBubble);
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }, 800); // 模拟网络延迟
    }

    // 支持回车发送
    document.getElementById('user-input').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') sendMessage();
    });
</script>
</body>
</html>
