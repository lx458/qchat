<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>量子计算VQE算法对话展示平台</title>
    <!-- 引入现代字体 Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- 引入 Font Awesome 图标库 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.1/dist/mermaid.min.js"></script>
    <style>
        /* 全局字体设置 */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* 气泡样式微调 */
        .user-bubble { background-color: #4338ca; color: white; border-radius: 1.25rem 1.25rem 0.25rem 1.25rem; padding: 0.75rem 1rem; margin: 0.5rem 0; max-width: 70%; align-self: flex-end; word-wrap: break-word; box-shadow: 0 4px 12px rgba(67, 56, 202, 0.2); }
        .ai-bubble { background-color: #f3f4f6; color: #1f2937; border-radius: 1.25rem 1.25rem 1.25rem 0.25rem; padding: 0.75rem 1rem; margin: 0.5rem 0; max-width: 70%; align-self: flex-start; word-wrap: break-word; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); }
        
        /* 滚动条美化 */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #e5e7eb; border-radius: 3px; }
        ::-webkit-scrollbar-thumb { background-color: #9ca3af; border-radius: 3px; }

        /* Tab 切换动画 */
        .tab-content {
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
            opacity: 0;
            transform: translateY(10px);
            display: none;
        }
        .tab-content.active-tab {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        /* 针对 chat tab 的特殊处理 */
        #chat.active-tab {
            display: flex;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col text-gray-800">
    <!-- 导航栏 -->
    <nav class="bg-indigo-800 text-white p-4 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold tracking-tight">量子计算 VQE 算法</h1>
            <div class="space-x-1 md:space-x-2">
                <button onclick="showTab('intro')" class="hover:bg-indigo-700 px-4 py-2 rounded-lg transition-all duration-200 flex items-center gap-2"><i class="fa-solid fa-book"></i>算法介绍</button>
                <button onclick="showTab('h2calc')" class="hover:bg-indigo-700 px-4 py-2 rounded-lg transition-all duration-200 flex items-center gap-2"><i class="fa-solid fa-flask"></i>氢分子计算</button>
                <button onclick="showTab('chat')" class="hover:bg-indigo-700 px-4 py-2 rounded-lg transition-all duration-200 flex items-center gap-2"><i class="fa-solid fa-comments"></i>对话互动</button>
            </div>
        </div>
    </nav>

    <!-- 主要内容区 -->
    <main class="container mx-auto flex-1 p-4 md:p-8">
        <!-- 1. 算法介绍Tab -->
        <div id="intro" class="tab-content active-tab">
            <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8 mb-8">
                <h2 class="text-2xl font-bold text-indigo-700 mb-6 flex items-center gap-3"><i class="fa-solid fa-atom"></i>VQE 算法核心原理</h2>
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-xl font-semibold mb-3 text-gray-700">什么是 VQE？</h3>
                        <p class="text-gray-600 mb-4 leading-relaxed">变分量子本征求解器（VQE）是量子-经典混合算法，用于求解分子体系的基态能量，是 NISQ 时代的核心量子化学算法。</p>
                        
                        <h3 class="text-xl font-semibold mb-3 text-gray-700">核心流程</h3>
                        <ol class="list-decimal list-inside text-gray-600 space-y-2 mb-4 pl-2">
                            <li>构造参数化量子电路（Ansatz）制备试验波函数</li>
                            <li>测量哈密顿量的期望值 \(E(\theta) = \langle\psi(\theta)|H|\psi(\theta)\rangle\)</li>
                            <li>经典优化器更新参数，最小化能量</li>
                            <li>迭代收敛，得到基态能量</li>
                        </ol>
                        
                        <h3 class="text-xl font-semibold mb-3 text-gray-700">为何适用于量子化学？</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2 pl-2">
                            <li>解决经典计算机的"维度灾难"（指数级增长的哈密顿量维度）</li>
                            <li>仅需浅层量子电路，适配 NISQ 硬件（噪声大、相干时间短）</li>
                        </ul>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-xl border border-gray-200 flex flex-col justify-center">
                        <h3 class="text-xl font-semibold mb-4 text-gray-700 text-center">VQE 算法流程图</h3>
                        <div class="mermaid h-72">
                            graph TD
                                A["初始化参数 θ"] --> B["制备量子态 |ψ(θ)⟩"]
                                B --> C["测量哈密顿量期望值 E(θ)"]
                                C --> D["经典优化器更新 θ"]
                                D --> F{"能量收敛？"}
                                F -- 否 --> B
                                F -- 是 --> G["输出基态能量 E₀"]
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                <h2 class="text-2xl font-bold text-indigo-700 mb-6 flex items-center gap-3"><i class="fa-solid fa-code"></i>DeepQuantum 安装指南</h2>
                <pre class="bg-gray-900 text-gray-100 p-4 md:p-6 rounded-xl overflow-x-auto text-sm leading-relaxed font-mono">
# 1. 创建并激活 Conda 环境
conda create -n dqenv python=3.12 -y
conda activate dqenv

# 2. 安装 PyTorch
pip install torch

# 3. 安装 DeepQuantum（二选一）
# 基础版
pip install deepquantum
# 开发者版
pip install deepquantum[dev]</pre>
            </div>
        </div>

        <!-- 2. 氢分子计算Tab -->
        <div id="h2calc" class="tab-content">
            <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                <h2 class="text-2xl font-bold text-indigo-700 mb-6 flex items-center gap-3"><i class="fa-solid fa-molecule-water"></i>氢分子（H₂）基态能量计算</h2>
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-xl font-semibold mb-4 text-gray-700">氢分子哈密顿量</h3>
                        <div class="bg-indigo-50 border border-indigo-200 p-5 rounded-xl mb-6">
                            <p class="text-gray-700 font-mono text-lg">H = -1.05237·(I⊗I) + 0.39794·(I⊗Z)</p>
                            <p class="text-gray-700 font-mono text-lg mt-1">  - 0.39794·(Z⊗I) - 0.01128·(Z⊗Z)</p>
                            <p class="text-gray-700 font-mono text-lg mt-1">  + 0.18093·(X⊗X)</p>
                        </div>
                        <p class="text-gray-600 italic">通过量子化学软件（如 PySCF）结合量子比特化（如 Jordan-Wigner 变换）得到。</p>
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold mb-4 text-gray-700">能量收敛曲线</h3>
                        <div class="h-72 bg-gray-50 p-4 rounded-xl border border-gray-200">
                            <canvas id="energyChart"></canvas>
                        </div>
                        <div class="bg-green-50 border border-green-200 p-5 rounded-xl mt-6">
                            <h3 class="text-lg font-semibold mb-2 text-gray-700">计算结果</h3>
                            <p class="text-gray-700 mb-1">最终收敛基态能量：<span class="font-bold text-green-700 text-xl">-1.137 Ha</span></p>
                            <p class="text-gray-600 text-sm">（1 Hartree ≈ 27.211 eV，实验值约 -1.136 Ha，误差小于 0.1%）</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3. 对话互动Tab -->
        <div id="chat" class="tab-content" style="flex-direction: column; height: 80vh; max-height: 800px;">
            <div class="bg-white rounded-2xl shadow-lg p-4 md:p-6 mb-6 flex-1 overflow-y-auto flex flex-col" id="chat-history">
                <div class="ai-bubble">
                    你好！我是量子计算 VQE 算法助手～ 可以问我关于 VQE 原理、DeepQuantum 安装、氢分子计算的问题，比如：
                    <br>1. 什么是 VQE 算法？
                    <br>2. 如何安装 DeepQuantum？
                    <br>3. 氢分子的基态能量是多少？
                </div>
            </div>
            <div class="flex flex-col gap-4">
                <div class="flex space-x-3">
                    <input type="text" id="user-input" placeholder="输入你的问题..." class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-gray-700">
                    <button id="send-button" class="bg-indigo-700 text-white px-6 py-3 rounded-lg hover:bg-indigo-800 transition-colors flex items-center gap-2 font-semibold"><i class="fa-solid fa-paper-plane"></i>发送</button>
                </div>
                <div class="flex flex-wrap gap-2">
                    <span class="text-sm text-gray-500 font-medium">快速提问:</span>
                    <button class="quick-question-btn bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg text-sm text-gray-700 transition-colors" data-question="什么是VQE算法？">什么是VQE算法？</button>
                    <button class="quick-question-btn bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg text-sm text-gray-700 transition-colors" data-question="如何安装DeepQuantum？">安装DeepQuantum</button>
                    <button class="quick-question-btn bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg text-sm text-gray-700 transition-colors" data-question="氢分子的基态能量是多少？">氢分子能量？</button>
                    <button class="quick-question-btn bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg text-sm text-gray-700 transition-colors" data-question="VQE为什么适用于量子化学？">VQE的优势？</button>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-indigo-800 text-white p-6 mt-auto">
        <div class="container mx-auto text-center text-gray-300">
            <p>量子计算 VQE 算法互动平台 &copy; 2024 | 基于 DeepQuantum 框架</p>
        </div>
    </footer>

<script>
    // 全局DOM加载完成后执行初始化
    document.addEventListener('DOMContentLoaded', () => {
        // 初始化Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'neutral',
            flowchart: { useMaxWidth: true, htmlLabels: true }
        });
        // 初始化图表
        initEnergyChart();
        // 初始化事件监听器
        initEventListeners();
    });

    // 初始化能量收敛曲线图
    function initEnergyChart() {
        const ctx = document.getElementById('energyChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: Array.from({length: 50}, (_, i) => i+1),
                datasets: [{
                    label: '能量值（Hartree）',
                    data: [
                        -0.8, -0.85, -0.92, -0.98, -1.03, -1.07, -1.09, -1.11, -1.12, -1.125,
                        -1.13, -1.132, -1.134, -1.135, -1.136, -1.1365, -1.1368, -1.1369, -1.137, -1.137,
                        -1.137, -1.137, -1.137, -1.137, -1.137, -1.137, -1.137, -1.137, -1.137, -1.137,
                        -1.137, -1.137, -1.137, -1.137, -1.137, -1.137, -1.137, -1.137, -1.137, -1.137,
                        -1.137, -1.137, -1.137, -1.137, -1.137, -1.137, -1.137, -1.137, -1.137, -1.137
                    ],
                    borderColor: '#4338ca',
                    backgroundColor: 'rgba(67, 56, 202, 0.1)',
                    borderWidth: 3,
                    pointBackgroundColor: '#4338ca',
                    pointBorderColor: '#fff',
                    pointHoverRadius: 6,
                    pointRadius: 4,
                    tension: 0.4,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { 
                        title: { display: true, text: '能量（Hartree）', font: { size: 14 } }, 
                        min: -1.2, 
                        max: -0.7,
                        grid: { color: 'rgba(0, 0, 0, 0.05)' }
                    },
                    x: { 
                        title: { display: true, text: '迭代次数', font: { size: 14 } },
                        grid: { display: false }
                    }
                },
                plugins: { 
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: '#1f2937',
                        titleFont: { size: 14, weight: 'bold' },
                        bodyFont: { size: 12 },
                        padding: 12,
                        cornerRadius: 8,
                        displayColors: false
                    }
                }
            }
        });
    }

    // 初始化所有事件监听器
    function initEventListeners() {
        document.getElementById('send-button').addEventListener('click', sendMessage);
        document.getElementById('user-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });
        document.querySelectorAll('.quick-question-btn').forEach(button => {
            button.addEventListener('click', () => {
                const question = button.dataset.question;
                document.getElementById('user-input').value = question;
                sendMessage();
            });
        });
    }

    // Tab切换功能 (已优化)
    function showTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.remove('active-tab');
        });
        const targetTab = document.getElementById(tabId);
        targetTab.classList.add('active-tab');
    }

    // 问答知识库
    const qaLibrary = {
        "什么是vqe算法？": "VQE（变分量子本征求解器）是量子-经典混合算法，核心是通过迭代优化参数化量子电路（Ansatz），求解分子哈密顿量的最小本征值（基态能量），适用于NISQ量子硬件，是量子化学的核心算法。",
        "如何安装deepquantum？": "安装步骤如下：<br>1. 创建Conda环境：<code class='bg-gray-100 text-gray-800 px-2 py-0.5 rounded'>conda create -n dqenv python=3.12 -y</code><br>2. 激活环境：<code class='bg-gray-100 text-gray-800 px-2 py-0.5 rounded'>conda activate dqenv</code><br>3. 安装PyTorch：<code class='bg-gray-100 text-gray-800 px-2 py-0.5 rounded'>pip install torch</code><br>4. 安装DeepQuantum：<code class='bg-gray-100 text-gray-800 px-2 py-0.5 rounded'>pip install deepquantum</code>",
        "氢分子的基态能量是多少？": "通过VQE算法计算，氢分子（H₂）的基态能量约为 <strong class='text-indigo-700'>-1.137 Hartree</strong>（1 Hartree≈27.211 eV），与实验值（-1.136 Ha）的误差小于0.1%，验证了算法的准确性。",
        "vqe为什么适用于量子化学？": "VQE适用于量子化学的两大核心原因：<br>1. 解决「维度灾难」：分子哈密顿量维度随电子数呈指数增长，经典计算机无法模拟<br>2. 适配NISQ硬件：仅需浅层电路，对量子比特数量、相干时间要求低，能容忍噪声"
    };

    // 发送消息和处理回复
    function sendMessage() {
        const userInputField = document.getElementById('user-input');
        const userInput = userInputField.value.trim();
        if (!userInput) return;

        const chatHistory = document.getElementById('chat-history');
        
        const userBubble = document.createElement('div');
        userBubble.className = 'user-bubble';
        userBubble.textContent = userInput;
        chatHistory.appendChild(userBubble);

        userInputField.value = '';
        chatHistory.scrollTop = chatHistory.scrollHeight;

        const processedInput = userInput.toLowerCase().replace(/[^\u4e00-\u9fa5a-z0-9？]/g, '');
        const matchedKey = Object.keys(qaLibrary).find(key => key.toLowerCase() === processedInput);

        setTimeout(() => {
            const aiBubble = document.createElement('div');
            aiBubble.className = 'ai-bubble';
            aiBubble.innerHTML = matchedKey ? qaLibrary[matchedKey] : 
                "抱歉，我暂时无法回答这个问题～ 可以试试问：<br>“什么是VQE算法？” 或 “如何安装DeepQuantum？”";
            chatHistory.appendChild(aiBubble);
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }, 800);
    }
</script>
</body>
</html>
